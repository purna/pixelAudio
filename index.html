<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Audio SFX Studio Pro</title>
    <!-- Fonts & Icons -->
    <link rel="icon" type="image/png" href="/pixelAudio/favicon-96x96.png" sizes="96x96" />
    <!-- Local Font Awesome Implementation -->
    <link rel="stylesheet" href="fonts/fontawesome-free-6.5.0/css/all.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/tutorials.css">
    <!-- Custom Font -->
    <style>
        @font-face {
            font-family: 'Inter';
            src: url('fonts/inter-normal.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
    </style>
</head>

<body>

    <!-- TOP HEADER -->
    <header>
        <div class="logo-area">
            <h1>Pixel Audio</h1>
            <span class="badge">Studio Pro V1.0</span>
        </div>
        <div class="header-controls">
            <button onclick="randomize()" class="tool-btn"><i class="fas fa-random"></i> Randomize</button>
            <div class="separator"></div>
            <button id="loadProject" class="header-btn"><i class="fas fa-folder-open"></i> Load</button>
            <button id="saveProject" class="header-btn primary"><i class="fas fa-save"></i> Save</button>
            <button id="exportMixBtn" class="header-btn action"><i class="fas fa-file-export"></i> Export Mix</button>
        </div>
    </header>

    <main>
        <!-- FAR LEFT ICON RAIL -->
        <div id="icon-sidebar">
            <button class="icon-tab-btn" data-panel="layers" data-tooltip-right="Layers">
                <i class="fas fa-layer-group"></i>
            </button>
            <button class="icon-tab-btn" data-panel="presets" data-tooltip-right="Presets">
                <i class="fas fa-th"></i>
            </button>
            <div class="sidebar-spacer"></div>
            <div class="separator" style="margin: 8px 0;"></div>
            <button class="icon-tab-btn" data-panel="settings" data-tooltip-right="Settings">
                <i class="fas fa-cog"></i>
            </button>
        </div>

        <!-- MAIN MIDDLE AREA -->
        <div id="workspace-area">

            <!-- FIXED LEFT TOOLS (SYNTH CONTROLS) -->
            <div id="fixed-tools-panel">
                <div class="tools-header">Synthesizer</div>

                <!-- Waveform -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Waveform</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="The raw oscillator shape&#10;&#10;**Square** → Classic 8-bit&#10;**Sawtooth** → Bright&#10;**Triangle** → Mellow&#10;**Sine** → Pure&#10;**Noise** → Explosions"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <select id="waveform">
                            <option value="square">Square</option>
                            <option value="sine">Sine</option>
                            <option value="triangle">Triangle</option>
                            <option value="sawtooth">Sawtooth</option>
                            <option value="noise">Noise</option>
                        </select>
                    </div>
                </div>

                <!-- Envelope -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Envelope</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="ADSR Volume Shape&#10;&#10;**Attack** → rise time&#10;**Sustain** → hold duration&#10;**Punch** → extra peak boost&#10;**Decay** → fade out"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group">
                            <label>Attack <span class="value" id="attackVal">0.00s</span></label>
                            <input type="range" id="attack" min="0" max="1" step="0.001" value="0">
                        </div>
                        <div class="control-group">
                            <label>Sustain <span class="value" id="sustainVal">0.10s</span></label>
                            <input type="range" id="sustain" min="0" max="2" step="0.01" value="0.1">
                        </div>
                        <div class="control-group">
                            <label>Decay <span class="value" id="decayVal">0.20s</span></label>
                            <input type="range" id="decay" min="0" max="2" step="0.01" value="0.2">
                        </div>
                        <div class="control-group">
                            <label>Punch <span class="value" id="punchVal">0%</span></label>
                            <input type="range" id="punch" min="0" max="100" step="1" value="0">
                        </div>
                    </div>
                </div>

                <!-- Frequency -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Frequency</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="Pitch Controls&#10;&#10;**Start** → Initial Hz&#10;**Slide** → Pitch change&#10;**Delta** → Acceleration"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group">
                            <label>Start Hz <span class="value" id="freqVal">440</span></label>
                            <input type="range" id="frequency" min="20" max="3000" value="440">
                        </div>
                        <div class="control-group">
                            <label>Slide <span class="value" id="slideVal">0.0</span></label>
                            <input type="range" id="slide" min="-2" max="2" step="0.01" value="0">
                        </div>
                        <div class="control-group">
                            <label>D-Slide <span class="value" id="deltaSlideVal">0.0</span></label>
                            <input type="range" id="deltaSlide" min="-1" max="1" step="0.01" value="0">
                        </div>
                    </div>
                </div>

                <!-- Vibrato -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Vibrato</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="Pitch Modulation&#10;&#10;**Depth** → Pitch variation %&#10;**Speed** → Wobble rate"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group checkbox-group">
                            <input type="checkbox" id="vibratoEnable">
                            <label for="vibratoEnable">Enable</label>
                        </div>
                        <div class="control-group mt-1">
                            <label>Depth <span class="value" id="vibratoDepthVal">0</span></label>
                            <input type="range" id="vibratoDepth" min="0" max="100" value="0">
                        </div>
                        <div class="control-group mt-1">
                            <label>Speed <span class="value" id="vibratoSpeedVal">0</span></label>
                            <input type="range" id="vibratoSpeed" min="0" max="50" step="0.1" value="0">
                        </div>
                    </div>
                </div>

                <!-- Arpeggio -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Arpeggio</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="Frequency Alternation&#10;&#10;Rapid note switching for 8-bit effects"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group checkbox-group">
                            <input type="checkbox" id="arpEnable">
                            <label for="arpEnable">Enable</label>
                        </div>
                        <div class="control-group mt-1">
                            <label>Mult <span class="value" id="arpMultVal">1.0</span></label>
                            <input type="range" id="arpMult" min="0.5" max="3" step="0.01" value="1">
                        </div>
                        <div class="control-group mt-1">
                            <label>Speed <span class="value" id="arpSpeedVal">0.0</span></label>
                            <input type="range" id="arpSpeed" min="0" max="1" step="0.001" value="0">
                        </div>
                    </div>
                </div>

                <!-- Duty Cycle -->
                <div class="control-section" id="duty-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Duty Cycle</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="Square Wave Pulse Width&#10;&#10;**Cycle** → Width %"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group">
                            <label>Cycle <span class="value" id="dutyVal">50%</span></label>
                            <input type="range" id="duty" min="0" max="100" value="50">
                        </div>
                    </div>
                </div>

                <!-- Layer Output -->
                <div class="control-section">
                    <div class="section-header">
                        <div class="label-group">
                            <span>Layer Output</span>
                            <i class="fas fa-circle-question info-icon"
                                data-tooltip="Volume for the selected layer"></i>
                        </div>
                        <button class="toggle-sect-btn"><i class="fas fa-minus"></i></button>
                    </div>
                    <div class="section-body">
                        <div class="control-group">
                            <label>Volume <span class="value" id="layerVolumeVal">100%</span></label>
                            <input type="range" id="layerVolume" min="0" max="200" step="1" value="100">
                        </div>
                    </div>
                </div>
            </div>

            <!-- CENTER VERTICAL STACK -->
            <div id="center-stack">

                <div id="oscilloscope-container">
                    <div class="vis-header">Oscilloscope</div>
                    <div class="canvas-holder">
                        <canvas id="waveform-preview"></canvas>
                    </div>
                </div>

                <div id="timeline-container">
                    <div class="timeline-controls">
                        <div class="transport">
                            <button id="playSelected" title="Play Layer"><i class="fas fa-play"></i> SEL</button>
                            <button id="playTimeline" class="accent-btn" title="Play All"><i
                                    class="fas fa-play-circle"></i> ALL</button>
                            <button id="stopTimeline" title="Stop"><i class="fas fa-stop"></i></button>
                        </div>
                        <div class="time-settings">
                            <label><i class="fas fa-clock"></i> <input type="number" id="totalLength" value="5" min="1"
                                    max="60" step="0.5">s</label>
                            <span id="timeDisplay">0.00s</span>
                        </div>
                        <div class="undo-redo">
                            <button id="undoBtn" title="Undo"><i class="fas fa-undo"></i></button>
                            <button id="redoBtn" title="Redo"><i class="fas fa-redo"></i></button>
                        </div>
                    </div>
                    <div class="timeline-canvas-wrapper">
                        <canvas id="timeline-canvas"></canvas>
                    </div>
                </div>

            </div>

            <!-- SLIDING RIGHT PANEL -->
            <div id="side-panel">

                <!-- LAYERS -->
                <div id="panel-layers" class="panel-content">
                    <div class="panel-title-row">
                        <h3>Layers</h3>
                        <button onclick="app.layerManager.addLayer()" class="small-btn"><i
                                class="fas fa-plus"></i></button>
                    </div>
                    <div id="layersList" class="scroll-list"></div>
                </div>

                <!-- PRESETS (GROUPED) -->
                <div id="panel-presets" class="panel-content">
                    <div class="panel-title-row">
                        <h3>Presets</h3>
                    </div>

                    <div class="preset-category">Game FX</div>
                    <div class="preset-grid">
                        <button class="preset-btn" onclick="loadPreset('pickup')"><i class="fas fa-coins"></i>
                            Pickup</button>
                        <button class="preset-btn" onclick="loadPreset('laser')"><i class="fas fa-bolt"></i>
                            Laser</button>
                        <button class="preset-btn" onclick="loadPreset('explosion')"><i class="fas fa-bomb"></i>
                            Boom</button>
                        <button class="preset-btn" onclick="loadPreset('powerup')"><i class="fas fa-rocket"></i>
                            Power</button>
                        <button class="preset-btn" onclick="loadPreset('hit')"><i class="fas fa-gavel"></i> Hit</button>
                        <button class="preset-btn" onclick="loadPreset('jump')"><i class="fas fa-angle-double-up"></i>
                            Jump</button>
                        <button class="preset-btn" onclick="loadPreset('alarm')"><i class="fas fa-bell"></i>
                            Alarm</button>
                    </div>

                    <div class="preset-category">Footsteps</div>
                    <div class="preset-grid">
                        <button class="preset-btn" onclick="loadPreset('step_stone')"><i class="fas fa-square"></i>
                            Stone</button>
                        <button class="preset-btn" onclick="loadPreset('step_wood')"><i class="fas fa-tree"></i>
                            Wood</button>
                        <button class="preset-btn" onclick="loadPreset('step_sand')"><i
                                class="fas fa-hourglass-start"></i> Sand</button>
                        <button class="preset-btn" onclick="loadPreset('step_snow')"><i class="fas fa-snowflake"></i>
                            Snow</button>
                        <button class="preset-btn" onclick="loadPreset('step_gravel')"><i class="fas fa-shapes"></i>
                            Gravel</button>
                    </div>

                    <div class="preset-category">UI & Synth</div>
                    <div class="preset-grid">
                        <button class="preset-btn" onclick="loadPreset('click')"><i class="fas fa-mouse-pointer"></i>
                            Click</button>
                        <button class="preset-btn" onclick="loadPreset('hover')"><i class="fas fa-hand-pointer"></i>
                            Hover</button>
                        <button class="preset-btn" onclick="loadPreset('blip')"><i class="fas fa-dot-circle"></i>
                            Blip</button>
                        <button class="preset-btn" onclick="loadPreset('synth_pad')"><i class="fas fa-music"></i>
                            Pad</button>
                    </div>
                </div>

            </div>

        </div>
    </main>

    <!-- SETTINGS MODAL - Matching pixelArt format -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal">
            <header>
                <div class="modal-title">
                    <i class="fas fa-cog"></i> Settings
                </div>
                <div style="font-size:0.8rem; color:#94a3b8; margin-bottom:15px;">
                    Configure your Pixel Audio Studio preferences
                </div>

                <div class="settings-tabs">
                    <button class="settings-tab active" data-tab="general" id="tab-general">
                        <i class="fas fa-sliders-h"></i> General
                    </button>
                    <button class="settings-tab" data-tab="audio" id="tab-audio">
                        <i class="fas fa-volume-up"></i> Audio
                    </button>
                    <button class="settings-tab" data-tab="export" id="tab-export">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <button class="settings-tab" data-tab="tutorial" id="tab-tutorial">
                        <i class="fas fa-graduation-cap"></i> Tutorial
                    </button>
                </div>
            </header>

            <div class="modal-content-wrapper">

                <div class="settings-tab-content active" data-tab-content="general">
                    <div class="settings-content">
                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-show-tooltips" checked>
                                <span class="checkmark"></span> Show Tooltips
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-auto-save" checked>
                                <span class="checkmark"></span> Auto Save
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-darkmode" checked>
                                <span class="checkmark"></span> Dark Mode
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="property-label">
                                Default Timeline Length (s):
                                <input type="number" id="settings-default-length" min="0.1" max="10" step="0.1"
                                    value="1.0"
                                    style="background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; padding: 6px 10px; font-size: 0.8rem; color: var(--text-primary); width: 100%; margin-top: 6px;">
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="property-label">
                                Theme:
                                <select id="settings-theme"
                                    style="background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; padding: 6px 10px; font-size: 0.8rem; color: var(--text-primary); width: 100%; margin-top: 6px;">
                                    <option value="dark" selected>Dark</option>
                                    <option value="light">Light</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-tab-content" data-tab-content="audio">
                    <div class="settings-content">
                        <div class="property-group">
                            <label class="property-label">
                                Master Volume:
                                <input type="range" id="settings-master-volume" min="0" max="100" value="100"
                                    style="width: 100%; margin-top: 6px;">
                                <span class="range-value" id="master-volume-value"
                                    style="font-family: 'Press Start 2P', cursive; font-size: 10px; color: var(--accent-tertiary);">100%</span>
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-auto-play" checked>
                                <span class="checkmark"></span> Auto Play on Preset Load
                            </label>
                        </div>
                    </div>
                </div>

                <div class="settings-tab-content" data-tab-content="export">
                    <div class="settings-content">
                        <div class="property-group">
                            <label class="property-label">
                                Export Quality:
                                <input type="range" id="settings-export-quality" min="0.1" max="1.0" step="0.1"
                                    value="1.0" style="width: 100%; margin-top: 6px;">
                                <span class="range-value" id="export-quality-value"
                                    style="font-family: 'Press Start 2P', cursive; font-size: 10px; color: var(--accent-tertiary);">100%</span>
                            </label>
                        </div>
                        <div class="property-group">
                            <label class="property-label">
                                Export Format:
                                <select id="settings-export-format"
                                    style="background: var(--bg-light); border: 1px solid var(--border-color); border-radius: 4px; padding: 6px 10px; font-size: 0.8rem; color: var(--text-primary); width: 100%; margin-top: 6px;">
                                    <option value="wav" selected>WAV (Lossless)</option>
                                    <option value="mp3">MP3 (Compressed)</option>
                                    <option value="ogg">OGG (Compressed)</option>
                                    <option value="midi">MIDI (Music Data)</option>
                                </select>
                            </label>
                        </div>
                        <div class="property-group"
                            style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                            <button id="exportDefaultsBtn" class="btn" style="margin-bottom: 8px; width: 100%;">
                                <i class="fas fa-cloud-download-alt"></i> Export Defaults
                            </button>
                            <button id="saveToBrowserBtn" class="btn" style="margin-bottom: 8px; width: 100%;">
                                <i class="fas fa-save"></i> Save to Browser
                            </button>
                            <button id="loadFromBrowserBtn" class="btn secondary" style="width: 100%;">
                                <i class="fas fa-download"></i> Load from Browser
                            </button>
                        </div>
                    </div>
                </div>

                <div class="settings-tab-content" data-tab-content="tutorial">
                    <div class="settings-content">
                        <div class="property-group">
                            <label class="property-label">
                                Tutorial Settings
                            </label>
                        </div>

                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-enable-tutorials" checked>
                                <span class="checkmark"></span> Enable Tutorials
                            </label>
                            <div
                                style="font-size: 11px; color: var(--text-secondary); margin-top: 4px; margin-left: 30px;">
                                Show interactive tutorials on startup
                            </div>
                        </div>

                        <div class="property-group">
                            <label class="setting-label">
                                <input type="checkbox" id="settings-show-hints" checked>
                                <span class="checkmark"></span> Show Tutorial Hints
                            </label>
                            <div
                                style="font-size: 11px; color: var(--text-secondary); margin-top: 4px; margin-left: 30px;">
                                Display helpful hints and tooltips
                            </div>
                        </div>

                        <div class="property-group"
                            style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--border-color);">
                            <button id="startTutorialBtn" class="btn" style="width: 100%;">
                                <i class="fas fa-graduation-cap"></i> Start Tutorial
                            </button>
                        </div>
                    </div>
                </div>

            </div>

            <footer>
                <div class="modal-actions">
                    <button class="btn" id="btn-settings-reset">Reset</button>
                    <button class="btn" id="btn-settings-close">Close</button>
                    <button class="btn primary" id="btn-settings-save">Save Settings</button>
                </div>
            </footer>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/audioEngine.js"></script>
    <script src="js/soundGenerator.js"></script>
    <script src="js/presets.js"></script>
    <script src="js/layerManager.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/fileManager.js"></script>
    <script src="js/tooltip.js"></script>
    <script src="js/tutorialConfig.js"></script>
    <script src="js/tutorialSystem.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/settings-manager.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/main.js"></script>
</body>

</html>